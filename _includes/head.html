<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  {%- seo -%}
  <link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
  <link rel="stylesheet" href="{{ "/assets/main.css" | relative_url }}">
  
  <!-- Lightbox for click-to-zoom images -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.4/css/lightbox.min.css" integrity="sha512-ZKX+BvQihRJPA5pCggLptAEySGlr3HVwr04SNsklMDWjsmROUdrSD5RQR7B+0UFIIRu8ba5DKJ+kR00prÃ©Epcw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.4/lightbox.min.js" integrity="sha512-3nYvJvJ1XO0sFIJPmAX5GBfCqBEZRywbVE9Wz0FwNTMmb2UUJ0LKNb+SpUm+l6u1/kRy4xgCj0VYU4a+P+JAcA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  {%- feed_meta -%}
  {%- if jekyll.environment == 'production' and site.google_analytics -%}
    {%- include google-analytics.html -%}
  {%- endif -%}

  {% if site.use_math %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
          delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
          ]}
        );
      });
    </script>
  {% endif %}

  <script>
  function initLightbox() {
    // Wrap images with titles in figures and captions
    var elements = document.querySelectorAll(".post img:not(figure img)");
    Array.prototype.forEach.call(elements, function(el, i) {
        if (el.getAttribute("title")) {
            const caption = document.createElement('figcaption');
            var node = document.createTextNode(el.getAttribute("title"));
            caption.appendChild(node);
            const wrapper = document.createElement('figure');
            wrapper.className = 'image';
            el.parentNode.insertBefore(wrapper, el);
            el.parentNode.removeChild(el);
            wrapper.appendChild(el);
            wrapper.appendChild(caption);
        }
    });
    
    // Reinitialize Lightbox after DOM changes
    if (typeof lightbox !== 'undefined') {
      lightbox.option({
        'resizeDuration': 200,
        'wrapAround': true,
        'albumLabel': 'Image %1 of %2',
        'disableScrolling': false
      });
    }
  }
  
  // Initialize on page load
  if (document.readyState === "loading") {
    document.addEventListener('DOMContentLoaded', initLightbox);
  } else {
    initLightbox();
  }
  </script>

</head>
